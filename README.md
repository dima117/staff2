# staff2

## TODO

- [x] сборка TypeScript на сервере (nest) и клиенте
- [x] общий роутер для сервера и клиента (router5)
- [x] рендеринг компонентов на сервере
- [x] title и meta-тэги
- [x] подключение клиентских бандлов
- [x] code splitting и ленивая загрузка бандлов
- [x] redux + redux observable
- [ ] загрузка страничных данных
- [ ] корневой роут
- [ ] инкрементальная сборка
- [ ] рендеринг страниц ошибок (403, 404, 500, клиентские ошибки)
- [ ] typed i18n

- [ ] настроить линтеры и автоформатирование
- [x] параллельный запуск всего
- [ ] favicon

- [ ] вынести настройки в конфиг
- [ ] TVM
- [ ] авторизация
- [ ] поход в бэкенд с проверкой формата
- [ ] error booster на клиенте и сервере
- [ ] логирование
- [ ] rum, Метрика, Baobab
- [ ] эксперименты

- [ ] модульные тесты
- [ ] интеграционные тесты с новой Гермионой

- [ ] опциональный анализатор бандлов в dev реиме

- деплой

### Code splittig + SSR

1. webpack разбивает на бандлы, если встречает динамический импорт И если подключен `@babel/plugin-syntax-dynamic-import`
2. на клиенте рендеринг в 2 этапа: сначала рендерим заглушку, загружаем бандл, рендерим вместо заглушки компонент
3. на сервере рендеринг синхронный и нужно предзагружать бандл
4. т.к. на сервере рендерится всё сразу, а на клиенте в 2 этапа, то при гидрации получаем ошибку о том, что серверный html не соответствует клиентскому. поэтомуна клиенте тоже нужно предзагрузить начальный бандл
5. в общем случае, технически трудно узнать, что именно нужно предзагрузить, но если есть ограничение, что бандлы разбиваются по страницам, то можем загрузить бандл, т.к. знаем текущую страницу
